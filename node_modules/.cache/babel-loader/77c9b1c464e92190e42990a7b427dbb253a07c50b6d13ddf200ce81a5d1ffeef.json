{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\dale pantano\\\\Downloads\\\\updated_frontend_no_auth\\\\app\\\\src\\\\pages\\\\CreateTicketPage.jsx\",\n  _s = $RefreshSig$();\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CreateTicketPage = () => {\n  _s();\n  var _localStorage$getItem;\n  const [title, setTitle] = useState('');\n  const [description, setDescription] = useState('');\n  const [severity, setSeverity] = useState('Low');\n  const [status, setStatus] = useState('Open');\n  const [departmentId, setDepartmentId] = useState(1);\n  const [error, setError] = useState('');\n  const navigate = useNavigate();\n  const username = (_localStorage$getItem = localStorage.getItem('username')) === null || _localStorage$getItem === void 0 ? void 0 : _localStorage$getItem.toLowerCase();\n  useEffect(() => {\n    // Set departmentId only\n    if (username === 'supervisor1') setDepartmentId(1); // IT\n    if (username === 'supervisor2') setDepartmentId(2); // HR\n    if (username === 'supervisor3') setDepartmentId(3); // Finance\n  }, [username]);\n\n  // ❌ Not authorized\n  if (username !== 'supervisor1' && username !== 'supervisor2' && username !== 'supervisor3') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-6 text-red-600 font-semibold\",\n      children: \"Access denied. Only supervisors can create tickets.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 21,\n      columnNumber: 12\n    }, this);\n  }\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setError('You must be logged in to submit a ticket.');\n      return;\n    }\n    try {\n      await axios.post('https://localhost:62423/api/Tickets', {\n        title,\n        description,\n        severity,\n        status,\n        departmentId\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        }\n      });\n      navigate('/tickets');\n    } catch (err) {\n      var _err$response;\n      console.error('Failed to create ticket:', err);\n      if (((_err$response = err.response) === null || _err$response === void 0 ? void 0 : _err$response.status) === 401) {\n        setError('Unauthorized. Please log in again.');\n      } else {\n        setError('Error creating ticket. Please try again.');\n      }\n    }\n  };\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-6 text-red-600 font-semibold\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-6 max-w-xl mx-auto\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-2xl font-bold mb-4\",\n      children: \"Create Ticket\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      className: \"space-y-4\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n};\n_s(CreateTicketPage, \"poRd9RztSfws9DqzY29WVngsaO0=\", true);\n_c = CreateTicketPage;\nvar _c;\n$RefreshReg$(_c, \"CreateTicketPage\");","map":{"version":3,"names":["CreateTicketPage","_s","_localStorage$getItem","title","setTitle","useState","description","setDescription","severity","setSeverity","status","setStatus","departmentId","setDepartmentId","error","setError","navigate","useNavigate","username","localStorage","getItem","toLowerCase","useEffect","_jsxDEV","className","children","fileName","_jsxFileName","lineNumber","columnNumber","handleSubmit","e","preventDefault","token","axios","post","headers","Authorization","err","_err$response","console","response","onSubmit","_c","$RefreshReg$"],"sources":["C:/Users/dale pantano/Downloads/updated_frontend_no_auth/app/src/pages/CreateTicketPage.jsx"],"sourcesContent":["const CreateTicketPage = () => {\n  const [title, setTitle] = useState('');\n  const [description, setDescription] = useState('');\n  const [severity, setSeverity] = useState('Low');\n  const [status, setStatus] = useState('Open');\n  const [departmentId, setDepartmentId] = useState(1);\n  const [error, setError] = useState('');\n  const navigate = useNavigate();\n\n  const username = localStorage.getItem('username')?.toLowerCase();\n\n  useEffect(() => {\n    // Set departmentId only\n    if (username === 'supervisor1') setDepartmentId(1); // IT\n    if (username === 'supervisor2') setDepartmentId(2); // HR\n    if (username === 'supervisor3') setDepartmentId(3); // Finance\n  }, [username]);\n\n  // ❌ Not authorized\n  if (username !== 'supervisor1' && username !== 'supervisor2' && username !== 'supervisor3') {\n    return <div className=\"p-6 text-red-600 font-semibold\">Access denied. Only supervisors can create tickets.</div>;\n  }\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setError('You must be logged in to submit a ticket.');\n      return;\n    }\n\n    try {\n      await axios.post(\n        'https://localhost:62423/api/Tickets',\n        {\n          title,\n          description,\n          severity,\n          status,\n          departmentId,\n        },\n        {\n          headers: {\n            Authorization: `Bearer ${token}`,\n            'Content-Type': 'application/json',\n          },\n        }\n      );\n      navigate('/tickets');\n    } catch (err) {\n      console.error('Failed to create ticket:', err);\n      if (err.response?.status === 401) {\n        setError('Unauthorized. Please log in again.');\n      } else {\n        setError('Error creating ticket. Please try again.');\n      }\n    }\n  };\n\n  if (error) {\n    return <div className=\"p-6 text-red-600 font-semibold\">{error}</div>;\n  }\n\n  return (\n    <div className=\"p-6 max-w-xl mx-auto\">\n      <h1 className=\"text-2xl font-bold mb-4\">Create Ticket</h1>\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        {/* Form inputs... */}\n      </form>\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}